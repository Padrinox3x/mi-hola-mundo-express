<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Formulario Validado</title>
    <link rel="stylesheet" href="css/formulario.css">
</head>
<body>

<form id="formulario" novalidate>
    <h2>Registro</h2>

    <label>Nombre</label>
    <input type="text" id="nombre" maxlength="30">
    <div class="mensaje-error" id="error-nombre"></div>

    <label>Apellido Paterno</label>
    <input type="text" id="apellidoP" maxlength="30">
    <div class="mensaje-error" id="error-apellidoP"></div>

    <label>Apellido Materno</label>
    <input type="text" id="apellidoM" maxlength="30">
    <div class="mensaje-error" id="error-apellidoM"></div>

    <label>Usuario</label>
    <input type="text" id="usuario" maxlength="20">
    <div class="mensaje-error" id="error-usuario"></div>

    <label>Contrase√±a</label>
    <div class="password-box">
        <input type="password" id="password" maxlength="30">
        <button type="button" id="verPass">üëÅÔ∏è</button>
    </div>
    <div id="fuerzaPassword" class="fuerza"></div>
    <div class="mensaje-error" id="error-password"></div>

    <label>Repetir Contrase√±a</label>
    <input type="password" id="password2" maxlength="30">
    <div class="mensaje-error" id="error-password2"></div>

    <label>LADA</label>
    <input type="text" id="lada" maxlength="3">
    <div class="mensaje-error" id="error-lada"></div>

    <label>Tel√©fono</label>
    <input type="text" id="telefono" maxlength="10">
    <div class="mensaje-error" id="error-telefono"></div>

    <label>Fecha de Nacimiento</label>
    <input type="date" id="fecha">
    <div class="mensaje-error" id="error-fecha"></div>

    <div class="botones">
        <button type="submit">Registrar</button>
        <a href="/"><button type="button">‚¨Ö Regresar</button></a>
    </div>
</form>

<script>
document.addEventListener("DOMContentLoaded", () => {

    const soloLetrasRegex = /[^A-Za-z√Å√â√ç√ì√ö√°√©√≠√≥√∫√ë√±]/g;
    const soloNumerosRegex = /^[0-9]+$/;
    const passwordRegex = /^(?=.*[A-Z])(?=.*[!@#$%^&*(),.?":{}|<>]).{8,30}$/;

    const marcarValido = (id) => {
        const input = document.getElementById(id);
        input.classList.remove("invalido");
        input.classList.add("valido");
        document.getElementById("error-" + id).textContent = "";
    };

    const marcarInvalido = (id, mensaje) => {
        const input = document.getElementById(id);
        input.classList.remove("valido");
        input.classList.add("invalido");
        document.getElementById("error-" + id).textContent = mensaje;
    };

    ["nombre", "apellidoP", "apellidoM", "usuario"].forEach(id => {
        document.getElementById(id).addEventListener("input", function () {
            this.value = this.value.replace(soloLetrasRegex, "");
        });
    });

    // Mostrar / ocultar contrase√±a
    document.getElementById("verPass").addEventListener("click", () => {
        const pass = document.getElementById("password");
        pass.type = pass.type === "password" ? "text" : "password";
    });

    // Fuerza de contrase√±a
    const passwordInput = document.getElementById("password");
    const fuerzaDiv = document.getElementById("fuerzaPassword");

    passwordInput.addEventListener("input", () => {
        const v = passwordInput.value;
        let fuerza = 0;

        if (v.length >= 8) fuerza++;
        if (/[A-Z]/.test(v)) fuerza++;
        if (/[0-9]/.test(v)) fuerza++;
        if (/[!@#$%^&*(),.?":{}|<>]/.test(v)) fuerza++;

        fuerzaDiv.className = "fuerza";

        if (fuerza <= 1) {
            fuerzaDiv.textContent = "üîê D√©bil";
            fuerzaDiv.classList.add("debil");
        } else if (fuerza <= 3) {
            fuerzaDiv.textContent = "üîê Media";
            fuerzaDiv.classList.add("media");
        } else {
            fuerzaDiv.textContent = "üîê Fuerte";
            fuerzaDiv.classList.add("fuerte");
        }
    });

    // SUBMIT
    document.getElementById("formulario").addEventListener("submit", e => {
        e.preventDefault();

        const campos = ["nombre","apellidoP","apellidoM","usuario","password","password2","lada","telefono","fecha"];
        let ok = true;

        campos.forEach(id => {
            if (!document.getElementById(id).value.trim()) {
                marcarInvalido(id, "Campo obligatorio");
                ok = false;
            } else {
                marcarValido(id);
            }
        });

        if (!soloNumerosRegex.test(lada.value)) {
            marcarInvalido("lada", "Solo n√∫meros");
            ok = false;
        }

        if (telefono.value.length !== 10) {
            marcarInvalido("telefono", "Debe tener 10 d√≠gitos");
            ok = false;
        }

        if (!passwordRegex.test(password.value)) {
            marcarInvalido("password", "Debe tener may√∫scula y car√°cter especial");
            ok = false;
        }

        if (password.value !== password2.value) {
            marcarInvalido("password2", "Las contrase√±as no coinciden");
            ok = false;
        }

        if (ok) {
            alert("Formulario v√°lido ‚úÖ");
        }
    });

});
</script>

</body>
</html>
