<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Formulario Validado</title>
    <link rel="stylesheet" href="css/formulario.css">
    <link rel="stylesheet" href="css/breadcrums.css">
</head>
<body>

<div class="main-container">
<form id="formulario" method="POST" action="/formulario" novalidate>

    <h2>Registro</h2>

    <label>Nombre</label>
    <input type="text" id="nombre" name="Nombre" maxlength="30">
    <div class="mensaje-error" id="error-nombre"></div>

    <label>Apellido Paterno</label>
    <input type="text" id="apellidoP" name="ApellidoP" maxlength="30">
    <div class="mensaje-error" id="error-apellidoP"></div>

    <label>Apellido Materno</label>
    <input type="text" id="apellidoM" name="ApellidoM" maxlength="30">
    <div class="mensaje-error" id="error-apellidoM"></div>

    <label>Usuario</label>
    <input type="text" id="usuario" name="Usuario" maxlength="20">
    <div class="mensaje-error" id="error-usuario"></div>

    <label>Contrase√±a</label>
    <div class="password-box">
        <input type="password" id="password" name="Password" maxlength="30">
        <button type="button" id="verPass">üëÅÔ∏è</button>
    </div>
    <div id="fuerzaPassword" class="fuerza"></div>
    <div class="mensaje-error" id="error-password"></div>

    <label>Repetir Contrase√±a</label>
    <input type="password" id="password2" maxlength="30">
    <div class="mensaje-error" id="error-password2"></div>

    <label>Correo Electr√≥nico</label>
    <input type="email" id="correo" name="Correo" maxlength="50">
    <div class="mensaje-error" id="error-correo"></div>

    <label>Tel√©fono</label>
    <input type="text" id="telefono" name="Telefono" maxlength="10">
    <div class="mensaje-error" id="error-telefono"></div>

    <label>Fecha de Nacimiento</label>
    <input type="date" id="fecha" name="FechaNacimiento">
    <div class="mensaje-error" id="error-fecha"></div>

    <div class="botones">
        <button type="submit">Registrar</button>
        <a href="/"><button type="button">‚¨Ö Regresar</button></a>
    </div>

</form>

<h3>Registros</h3>
<table id="tabla">
    <thead>
        <tr>
            <th>Nombre</th>
            <th>Usuario</th>
            <th>Correo</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

</div>

<script src="js/breadcrumbs.js"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {

    const soloLetras = /[^A-Za-z√Å√â√ç√ì√ö√°√©√≠√≥√∫√ë√±]/g;
    const soloNumeros = /^[0-9]+$/;
    const passwordRegex = /^(?=.*[A-Z])(?=.*[!@#$%^&*(),.?":{}|<>]).{8,30}$/;

    const marcarInvalido = (id, msg) => {
        document.getElementById(id).classList.add("invalido");
        document.getElementById("error-" + id).textContent = msg;
    };

    const marcarValido = (id) => {
        document.getElementById(id).classList.remove("invalido");
        document.getElementById("error-" + id).textContent = "";
    };

    ["nombre","apellidoP","apellidoM"].forEach(id => {
        document.getElementById(id).addEventListener("input", e => {
            e.target.value = e.target.value.replace(soloLetras, "");
        });
    });

    document.getElementById("verPass").addEventListener("click", () => {
        const pass = document.getElementById("password");
        pass.type = pass.type === "password" ? "text" : "password";
    });

    document.getElementById("formulario").addEventListener("submit", e => {
        e.preventDefault();
        let ok = true;

        const campos = ["nombre","apellidoP","apellidoM","usuario","password","password2","correo","telefono","fecha"];

        campos.forEach(id => {
            if (!document.getElementById(id).value.trim()) {
                marcarInvalido(id, "Campo obligatorio");
                ok = false;
            } else {
                marcarValido(id);
            }
        });

        if (!soloNumeros.test(telefono.value) || telefono.value.length !== 10) {
            marcarInvalido("telefono", "Debe tener 10 d√≠gitos");
            ok = false;
        }

        if (!passwordRegex.test(password.value)) {
            marcarInvalido("password", "Debe tener may√∫scula y car√°cter especial");
            ok = false;
        }

        if (password.value !== password2.value) {
            marcarInvalido("password2", "No coinciden");
            ok = false;
        }

        if (ok) guardarRegistro();
    });

});
</script>

</body>
</html>
